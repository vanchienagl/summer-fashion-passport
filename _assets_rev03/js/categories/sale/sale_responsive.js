
(function($,window,undefined){var tm=TweenMax;var loc=location.pathname;var ua=navigator.userAgent;function equalHeight(gridIndex,gridItemParent,gridItemChild){var get_data=$(gridItemParent).data('cols'),target=$(gridItemParent).find(gridItemChild),index=parseInt(gridIndex),cols=parseInt(get_data),rows=Math.ceil(index/cols);for(var i=0;i<rows;i++){var maxHeight=0;for(var j=0;j<cols;j++){if($(target).eq(i*cols+j).height()>maxHeight){maxHeight=$(target).eq(i*cols+j).height();}}
for(var k=0;k<cols;k++){$(target).eq(i*cols+k).height(maxHeight);}}};function saleCMS(_classParent,_classChild){$('.grid').each(function(i){var child$=$(this).children(_classParent).length;var _name=$(this).children(_classParent).find(_classChild);var _nameLen=$(_name).length;for(var i=0;i<Math.ceil(_nameLen/child$);i++){var maxHeight=0;for(var j=0;j<child$;j++){if($(_name).eq(i*child$+j).height()>maxHeight){maxHeight=$(_name).eq(i*child$+j).height();}}
for(var k=0;k<child$;k++){$(_name).eq(i*child$+k).height(maxHeight);}}});};_SalePage=function(){this.isInit=false;this._init();};_SalePage.prototype={win:$(window),_init:function(){if(this.isInit)return false;this.isInit=true;this.timer=false;this.isAccordion=false;if(!window.innerWidth){this.w=$(window).width();return;}else{this.w=window.innerWidth;}
this.h=$(window).height();if(ua.indexOf('iPhone')>0||ua.indexOf('iPod')>0||ua.indexOf('Android')>0&&ua.indexOf('Mobile')>0){this.ua='mobile';}else if(ua.indexOf('iPad')>0||ua.indexOf('Android')>0){this.ua='tablet';}else{this.ua='pc';}
this.screen=true;this.breakpoint=979;this.url=loc.substring(0,loc.lastIndexOf('/'))+'/';this.win.on('load',$.proxy(this.onLoad,this));this.win.on('load',$.proxy(this.onLoadParam,this));this.win.on('resize onorientationchange',$.proxy(this.onResize,this));$('a[href*=#].scroll').on('click',function(){var _btn=this;$.proxy(_SalePage.onPageScroll(_btn),this);});this.onPageTop();this.img=[];this.onAjaxContents();this.onAccordion();new btnAction();},onLoad:function(){var s=this;var bnr_fin='<img src="/_assets/images/common/sale/bnr_fin.png" width="167" style="width: 167px; position: absolute; top: 0; bottom: 0; left: 0; right: 0; margin: auto; z-index: 2;"><div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: transparent url(/_assets/images/common/sale/bnr_bg-comingsoon.png) 0 0 repeat;"></div>',bnr_soon='<img src="/_assets/images/common/sale/bnr_comingsoon.png" width="167" style="width: 167px; position: absolute; top: 0; bottom: 0; left: 0; right: 0; margin: auto; z-index: 2;"><div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: transparent url(/_assets/images/common/sale/bnr_bg-comingsoon.png) 0 0 repeat;"></div>';$('.sale-bnr').find('.is-soon').css({'position':'relative'}).prepend(bnr_soon);$('.sale-bnr').find('.is-fin').css({'position':'relative'}).prepend(bnr_fin);if($('html').hasClass('device-type-pc')){$('a[data-href-mobile]').each(function(){$(this).removeAttr('data-href-mobile');});$('img[data-src-mobile]').each(function(){$(this).removeAttr('data-src-mobile');});}
$('a[data-href-mobile]').click(function(event){if(!_SalePage.screen){(event.preventDefault)?event.preventDefault():event.returnValue=false;var targetType=$(this).attr('target'),mobile_url=$(this).data('href-mobile');if(targetType=='_blank'){window.open(mobile_url,targetType);}else{window.location.href=mobile_url;}}});$('div[data-ico]').each(function(i){var ico=$(this).data('ico');$(this).find('.pickup-shop__body > *').wrapAll('<div class="js-pickup-text"></div>');$(this).find('.pickup-shop__body').prepend('<div class="js-pickup-ico"><img src="./_assets/images/ico'+ico+'.png" alt="" /></div>');});$('img[data-src-mobile]').each(function(i){var pc_src=$(this).attr('src'),mobile_src=$(this).data('src-mobile');$(this).attr('data-src-pc-cathe',pc_src);$(this).attr('data-src-mobile-cathe',mobile_src);});$('[data-bnr-soon]').each(function(){var num=$(this).data('bnr-soon');if(num==1){$(this).removeClass('btn-fade');$(this).append('<div style="position:absolute;width:100%;height:100%;background:rgba(0,0,0,0.6);top:0;bottom:0;z-index:2"><div style="position: absolute;left: 0;top: 0;bottom: 0;right: 0;margin: auto;width: 100%;text-align: center;color: #ffffff;font-size: 28px;height: 1em;font-weight: 600">Coming soon</div></div>');}});this.onResize();$('a.js-tel').on('click',function(event){if(_SalePage.screen){(event.preventDefault)?event.preventDefault():event.returnValue=false;}});this.onNavHasDrop();this.onLayoutShop();if(_SalePage.screen){s.onHashScroll();}else{setTimeout(function(){s.onHashScroll();},500);}},onGetParam:function(param){var s=this;$.extend({getParameter:function getParameter(){var arg=new Object;var pair=location.search.substring(1).split('&');for(i=0;pair[i];i++){var kv=pair[i].split('=');arg[kv[0]]=kv[1];}
return arg;}});var args=$.getParameter();return args;},onLoadParam:function(){var param=this.onGetParam();if(param.ac_state=="op"){$('.js-ac .js-ac-head .js-ac-head-btn').trigger('click');}
if(param.close==0){$('.js-close-mask').remove();$('.js-close-mask-dialog').remove();}},onResize:function(){var s=this;if(!window.innerWidth){this.w=$(window).width();return;}else{this.w=window.innerWidth;}
if(this.w>this.breakpoint){s.screen=true;}else{s.screen=false;}
if(_SalePage.screen){if($('body').hasClass('sale-page-detail')){window.location.href=this.url;}}
if(this.timer!==false){clearTimeout(this.timer);}
this.timer=setTimeout(function(){if(_SalePage.screen){$('.js-grid').each(function(i){var parent=$(this),item=$(this).find('.js-grid__item'),item_length=item.length,target=$(this).find('.js-grid-align'),align=target.length/item_length;item.each(function(i){var index=i+1;for(var i=0;i<align;i++){var name='js-grid-align'+i,cname='.'+name;$(this).find('.js-grid-align').eq(i).addClass(name);equalHeight(index,parent,cname);}});});$('.shop-list').each(function(){$(this).parent('.is-active').find('.js-ac-body[role="region"]').css({'height':'auto','overflow':'visible'});});}},200);this.onSwitchImage();this.h=$(window).height();},onSwitchImage:function(){var s=this;$('img[data-src-mobile]').each(function(i){var pc_src=$(this).attr('src'),mobile_src=$(this).data('src-mobile');if(_SalePage.screen){$(this).attr('src',$(this).data('src-pc-cathe'));}else{$(this).attr('src',$(this).data('src-mobile-cathe'));}});},onPageScroll:function(_this){var s=this;if(location.pathname.replace(/^\//,'')==_this.pathname.replace(/^\//,'')&&location.hostname==_this.hostname){var target=_this.hash;this.onPageScrollTo(target,500,0,0);event.preventDefault();}},onPageScrollTo:function(tar,speed,pos,delay){var target=$(tar);if($('.header-wrap').css('position')=='fixed'){var _h=$('.header-wrap').height();pos=pos-$('.header-wrap').height();}
if(target.size()>0){setTimeout(function(){var targetOffset=target.offset().top+pos;$("html,body").queue([]).stop();$('html,body').animate({scrollTop:targetOffset},{duration:speed,easing:"easeOutExpo"});},delay);}},onPageTop:function(){var pagetop=$('#nav-pagetop');$(window).scroll(function(){if($(this).scrollTop()>1100){pagetop.fadeIn();}else{pagetop.fadeOut();}});pagetop.click(function(){$('body, html').animate({scrollTop:0},500);return false;});},onAjaxContents:function(e){var s=this;var _ajax=function(){this.$b=$('.js-modal-pc');this.$b_new=$('[data-modal-pc="1"]');this.init();};_ajax.prototype={init:function(){var s=this;this.$b.on('click',function(e){var _html=$(this).attr('href');var _url=_SalePage.url+_html;s._modal(e,_url);_SalePage.onSwitchImage();});this.$b_new.on('click',function(e){var _html=$(this).attr('href');var _url=_SalePage.url+_html;s._modal(e,_url);_SalePage.onSwitchImage();});$(document).on('click','.btn-cover',function(e){var target=e.target;if(target.id==='cover'){$('#modal').remove();}});$(document).on('click','.js-modal-close',function(e){$('#modal').remove();});},_modal:function(event,_url){if(_SalePage.screen){(event.preventDefault)?event.preventDefault():event.returnValue=false;$.ajax({url:_url,type:'GET',dataType:'html'}).done(function(data){$('body').append('<div id="modal"><div id="cover" class="btn-cover"><div id="ajax-load-modal" class="modal-detail"></div></div></div>');$(data).find('#ajax-get-modal').each(function(){$("#ajax-load-modal").html($(this));$('#ajax-get-modal').append('<div class="modal-detail-close"><a href="javascript:void(0);" class="p-modal-close js-modal-close"><img src="/_assets/images/common/sale/btn_close.png" alt="Close" /></a></div>');});$('#ajax-get-modal img').load(function(){var _height=$('#ajax-load-modal').height();var y=($(window).height()-_height)*0.5;$('#ajax-load-modal').css({'position':'fixed','top':y+'px'});});}).fail(function(data){});}}};new _ajax();},onLayoutShop:function(){$('.shop.ico').each(function(){var _icoW=$(this).find('.ico--multi').width();var _shopNameW=$(this).find('.shop__name--multi').width();$(this).find('.shop__name--multi').css({width:_shopNameW-_icoW+'px'});});$('.shop-list').each(function(){do{$(this).children('.shop:lt(2)').wrapAll('<div class="grid"></div>');}while($(this).children('.shop').length);saleCMS('.shop','.shop__name');});$('.dropdown').each(function(){do{$(this).children('li:lt(2)').wrapAll('<div class="dropdown__row"></div>');}while($(this).children('li').length);$(this).find('li:nth-child(2)').addClass('last');});},onNavHasDrop:function(){$('.hasDrop').mouseenter(function(){var _btn=$(this).children('a');$('.header-menu__marker').show();tm.to($(_btn),0.4,{css:{color:'#9f005b'}});$(this).children('ul').stop(true,true).animate({opacity:'toggle',height:'toggle'},200);}).mouseleave(function(){var _btn=$(this).children('a');$('.header-menu__marker').hide();tm.to($(_btn),0.4,{css:{color:'#ffffff'}});$(this).find('.dropdown').stop(true,true).animate({opacity:'toggle',height:'toggle'},200,function(){$(this).hide().find('ul').hide();});});$('.header-menu__item:not(.hasDrop)').each(function(){var tar=$(this).find('a');$(tar).mouseenter(function(){tm.to($(this),0.4,{css:{color:'#9f005b'}});}).mouseleave(function(){tm.to($(this),0.4,{css:{color:'#ffffff'}});});});},onColorBox:function(){var _colorbox=function(){$('.p-modal-shop').append('<a href="#" class="p-modal-close js-modal-close"><img src="./_assets/images/btn_close.png" alt="閉じる" /></a>');this.init();};_colorbox.prototype={init:function(){this.start();$('.js-modal-close').on('click',$.proxy(this.close,this));},start:function(){$('.inline').colorbox({width:'100%',inline:true,overlayClose:true,preloading:true,loop:false,fixed:true,closeButton:false,maxWidth:'640px',opacity:0.7});},close:function(){parent.$.fn.colorbox.close();return false;}};new _colorbox();},onAccordion:function(el){var _accordion=function(){this.start();};_accordion.prototype={start:function(){this.a=$('.js-ac-head');var s=this;if($('.js-ac--arrow').size()>0){$('.js-ac--arrow').each(function(){$(this).find('.js-ac-head').prepend('<span class="ac-arrow"></span>');});}
$(this.a).on('click',function(){if(_SalePage.screen){return false;}else{var container=$(this).parents('.js-ac'),body=$(container).find('.js-ac-body[role="region"]'),body_height=parseInt($(body).css('height'));if(body_height===0){s.isAccordion=true;}
if($(container).hasClass('is-active')){tm.to($(body),0,{css:{height:'auto',overflow:'visible'}});s.isAccordion=false;body.attr('aria-hidden','false');$(this).attr('aria-expanded','true');}
if(s.isAccordion){tm.to($(body),0.4,{css:{height:'auto',overflow:'visible'},ease:' Expo.easeIn'});$(this).parents('.js-ac').addClass('is-active');body.attr('aria-hidden','false');$(this).attr('aria-expanded','true');}else{tm.to($(body),0.3,{css:{height:0,overflow:'hidden'},ease:' Expo.easeOut'});$(this).parents('.js-ac').removeClass('is-active');body.attr('aria-hidden','true');$(this).attr('aria-expanded','false');}}});}};new _accordion();},onHashScroll:function(){var _fixed=false,_headerHeight=0;if($('.header-wrap').css('position')=='fixed'){_fixed=true;}
if(_fixed){_headerHeight=$('header.header').height();}
if(location.hash){try{var _hash=location.hash,_offsetTop=$(_hash).offset().top-_headerHeight;$('html,body').animate({scrollTop:_offsetTop},{duration:1200,easing:"easeOutExpo"});$(_hash).trigger('click');}
catch(e){}}}};btnAction=function(){var s=this;this.btnFade=$('.btn-fade');$(document).on('mouseenter','.btn-fade',function(){tm.to($(this),0.4,{css:{opacity:0.5}});});$(document).on('mouseleave','.btn-fade',function(){tm.to($(this),0.6,{css:{opacity:1}});});};$(function(){_SalePage=new _SalePage();});})(jQuery,this);